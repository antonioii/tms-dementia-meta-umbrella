
'''
17/01/2025
==========
Algoritmo para Extração de Effect Size e IC95%
Python (google.colab)
* Input é uma planilha com 1 coluna, sendo que
	Cada linha contendo formato effectSize [IC_low, IC_up]
		

*Output são três listas printadas no console:
	Lista 1: Effect Size
	Lista 2: IC_low
	Lista 3: IC_up

Ex:
	INPUT: -0,07 [-1,31, 1,17]
	OUTPUT:
	Lista 1: -0,07
	Lista 2: -1,31
	Lista 3: 1,17
==========
'''

import pandas as pd
import re

# Função principal para processar a tabela
def process_excel_table(file_path):
    # Ler a planilha do Excel
    df = pd.read_excel(file_path)

    # Listas para armazenar os resultados
    smd_list = []
    ci_low_list = []
    ci_up_list = []

    # Iterar sobre cada linha da coluna 'Effect Size'
    for index, value in enumerate(df['Effect Size']):
        try:
            # Dividir a string no formato SMD [CI_low, CI_up]
            smd_part, ci_part = value.split('[')
            smd = smd_part.strip()  # SMD é a parte antes do colchete
            ci_part = ci_part.strip(' ]')  # Remover colchetes e espaços desnecessários

            # Dividir o intervalo de confiança usando split(',', 2)
            parts = ci_part.split(',', 2)
            ci_low = ','.join(parts[:2]).strip()  # Combina as duas primeiras partes para CI_low
            ci_up = parts[2].strip()  # Terceira parte é o CI_up

            # Adicionar os valores às respectivas listas
            smd_list.append(smd)
            ci_low_list.append(ci_low)
            ci_up_list.append(ci_up)
        except Exception as e:
            print(f"Erro na linha {index + 1}: {value}. Detalhes do erro: {e}")

    # Imprimir os resultados
    print(f"Foram lidas {len(df)} linhas de sua tabela.\n")
    print("A primeira lista (SMD) é:")
    print('\n'.join(smd_list), '\n')
    print("A segunda lista (CI_low) é:")
    print('\n'.join(ci_low_list), '\n')
    print("A terceira lista (CI_up) é:")
    print('\n'.join(ci_up_list))

# Caminho para o arquivo Excel (substitua o caminho pelo do seu arquivo!!!)
file_path = '/content/teste.xlsx'
process_excel_table(file_path)